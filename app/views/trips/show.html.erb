<div class="pt-5 mt-4"></div>
  <div class="d-flex justify-content-between px-5">
    <div class="h1"><%= @trip.trail.name %><span class="ml-3 badge badge-pill <% if @trip.trail.tag_list[0] === "easy"%>badge-success<% elsif @trip.trail.tag_list[0] === "medium"%>badge-warning<% else %>badge-danger<% end %> "><%= @trip.trail.tag_list[0] %></span></div>
    <div class="d-flex justify-content-end">
      <section><%= link_to 'Share', user_trip_path(@trip, format: :pdf), class: "btn btn-success", target: :_blank %></div>
    </div>
  </div>

  <div class="px-5 pb-5 mx-5" style="background-color:#e1e4d5;">
    <section class="row p-3 py-1" id="checklist-complete">
      <% if @trip.checklists.all?(&:checked) %>
        <div class="mr-2"><i class="fas fa-check-circle" style="color:darkcyan;"></i> Checklist completed!</div>
      <% else %>
        <div class="mr-2"><i class="fas fa-exclamation-circle" style="color:firebrick;"></i> Checklist is not complete!</div>
      <% end %>
    </section>
    <div class="row">
      <section class="col-7">
        <div class="bg-white shadow-sm p-3">
          <div class="h4"><%= @trip.start_date.strftime("%e %b, %Y") %> - <%= @trip.end_date.strftime("%e %b, %Y") %></div>
          <div class="mb-3"><%= @trip.trail.time_needed %> TRIP FOR <%= @trip.no_of_people %> <%= "adult".pluralize(@trip.no_of_people).upcase %> IN <%= @trip.trail.location.upcase %>.</div>
          <div class="row">
            <div class="col-6">
              <div class="d-flex align-items-center mb-2 h5">
                <div class="mr-3">
                  <% if @trip.camping %>
                    <i class="fas fa-check-circle" style="color:darkcyan;"></i>
                  <% else %>
                    <i class="fas fa-times-circle" style="color:tomato;"></i>
                  <% end %>
                </div>
                <div>
                  I will be sleeping in a tent
                </div>
              </div>
              <div class="d-flex align-items-center h5">
                <div class="mr-3">
                  <% if @trip.cooking %>
                    <i class="fas fa-check-circle" style="color:darkcyan;"></i>
                  <% else %>
                    <i class="fas fa-times-circle" style="color:tomato;"></i>
                  <% end %>
                </div>
                <div>
                  I will be cooking my own food
                </div>
              </div>
            </div>
            <div class="col-6">
              <div class="warning p-2 rounded-lg">
                <div class="h5 mt-2"></i> Emergency contact</div>
                <div class="pl-2"><%= @trip.emergency_contact.name %></div>
                <div class="pl-2"><%= @trip.emergency_contact.email %></div>
                <div class="pl-2"><%= @trip.emergency_contact.phone_no %></div>
                <div class="pl-2 mt-2"> <em>Alert will be sent on </em><strong><%= @trip.end_date.strftime("%e %b, %I %P") %></strong></div>
              </div>
            </div>
          </div>
        </div>
        <div class="bg-white shadow-sm p-3 my-3">
          <div class="h4">Day Plan and Conditions</div>
          <div class="accordion" id="accordionDay">
            <%= render "trip_weather_card", trip: @trip, trip_dates: [@trip_dates], trip_days: @trip_days, breakfast: @breakfast_arr, meal: @meal_arr, checkpoint_arr: @checkpoint_name_arr %>
          </div>
        </div>
        <div class="bg-white shadow-sm p-3 my-3">
          <div class="h4">Checklist</div>
          <div class="accordion" id="accordionChecklist">
            <% @category_items.each_with_index do |category, index| %>
              <div class="card">
                <div class="card-header" id="heading<%=category%>">
                  <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left text-black" type="button" data-toggle="collapse" data-target="#collapse<%=category%>" aria-expanded="true" aria-controls="collapse<%=index%>" style="text-decoration:none;">
                      <div data-checklist-target="category" id="<%=category%>" <% if @check_category_hash[category.to_sym] %>style="color:green;"<% end %>>
                        <%= image_tag "icons/#{category}.png", style:"height:32px;", class:"mr-2" %>
                        <%= category.titleize %>
                        <% if @check_category_hash[category.to_sym] %> <span id="<%=category%>-icon" style="font-size:1.5rem;"> <i class="far fa-check-circle"></i></span> <% end %>
                      </div>
                    </button>
                  </h2>
                </div>
                <div id="collapse<%=category%>" class="collapse <% if index===0%>show<% end %>" aria-labelledby="heading<%=category%>" data-parent="#accordionChecklist">
                  <%# /* CONTROLLER START */ %>
                  <div class="card-body" data-controller="checklist">
                    <%# UNDONE CHECKLIST %>
                    <div class="border-bottom mb-2" data-checklist-target="undone">
                      <%= render Item.unchecked_by_tag_name(category, @trip) %>
                    </div>
                    <%# DONE CHECKLIST %>
                    <div class="mt-2 text-muted" data-checklist-target="done">
                      <%= render Item.checked_by_tag_name(category, @trip) %>
                    </div>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </section>
      <div class="col-5">
        <div class="bg-white shadow-sm mb-3">
          <div id="map"
            class="map-with-route"
            style="width: 100%; height: 50vh;"
            data-markers="<%= @markers.to_json %>"
            data-coordinate-string="<%= @coordinate_string %>"
            data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
          </div>
          <div class="mt-3 p-3">
            <div>
              <%= line_chart @elevation_arr, colors: ["#337ab7", "#ffffff"],  ytitle: "Elevation",min: @min_no.to_s, max: @max_no, height: "180px";%>
            </div>
            <div class="d-flex justify-content-around px-3 py-2">
              <div class="text-center">
                <i class="fas fa-hiking"></i>
                <p><%= @trip.trail.route_distance %></p>
              </div>
              <div class="text-center">
                <i class="far fa-clock"></i>
                <p><%= @trip.trail.time_needed %></p>
              </div>
              <div class="text-center">
                <i class="fas fa-level-up-alt"></i>
              <p>(Elevation gain)</p>
              </div>
              <div class="text-center">
                <i class="fas fa-level-down-alt"></i>
                <p>(Elevation loss)</p>
              </div>
            </div>
          </div>

        </div>
        <div class="bg-white shadow-sm p-3 my-3">
          <div>
            <div class="d-flex justify-content-start align-items-center">
             <h4>Last seen</h4>
              <% if @trip.photo.present? %>
                <div class="ml-2"><i class="fas fa-check-circle" style="color:darkcyan;"></i> Photo uploaded! </div>
              <% else %>
                <div class="ml-2"><i class="fas fa-exclamation-circle" style="color:firebrick;"></i> Please upload a photo !</div>
              <% end %>
            </div>
              <% if @trip.photo.present? %>
                <div class="d-flex justify-content-between">
                  <div class="shadow-sm" style="width:45%;" >
                    <%= cl_image_tag (@trip.photo.key), class:"rounded-lg", style: "width:100%;object-fit:contain;", crop: :fill %>
                  </div>
                  <div class="p-2 rounded shadow" style="width:50%; font-size:1rem;background-color:#f8ffe2;">
                    <div class="mb-2 h5">Looking good!</div>
                    <div>This photo was taken on: </div>
                    <div><%= @trip.last_photo.strftime("%e %b, %Y") %> at <%= @trip.last_photo.strftime("%l:%M %P") %></div>
                  </div>
                </div>
              <% else %>
                <div class="p-2 shadow" style="background:floralwhite;">
                  <div class = "h5">Please attach a photo</div>
                    <%= simple_form_for([current_user, @trip], method: :patch, url: trip_path(@trip)) do |f| %>
                      <%= f.input :photo, class: 'invisible fixed-top form-label', as: :file, input_html: { multiple: false } %>
                      <div class="d-flex justify-content-center">
                        <label for="trip_photo" class="btn btn-outline-success m-0 mr-1" id='upload-btn'><i class="fas fa-camera"></i></label>
                        <button type="submit" class="btn btn-primary disabled" id='submit-btn' disabled>
                        Upload photo
                         </button>
                      </div>
                      <p id='helper-text' class='invisible text-center m-0'>no photo</p>
                    <% end %>
                </div>
              <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<%= render 'shared/footer'%>
